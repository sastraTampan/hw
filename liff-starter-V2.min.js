var liffId="1584968724-qzg0aR95",params=location.search.substring(1),url=window.location.href;if(params)try{params=JSON.parse('{"'+decodeURI(params.replace(/&/g,'","').replace(/=/g,'":"'))+'"}')}catch(e){getParameterByName=getParameterByNameV2}window.onload=function(){initVConsole(),initContent(),initLiff(liffId)};var HttpClient=function(){this.get=function(e,t){var a=new XMLHttpRequest;a.onreadystatechange=function(){4==a.readyState&&200==a.status&&t(a.responseText)},a.open("GET",e,!0),a.send(null)}};function initVConsole(){window.vConsole=new window.VConsole({defaultPlugins:["system","network","element","storage"],maxLogNumber:1e3,onReady:function(){console.log("vConsole is ready.")},onClearLog:function(){console.log("on clearLog")}})}function initLiff(e){console.log("Going to initialize LIFF to",e),liff.init({liffId:e}).then(()=>{"liffToken"==getParameterByName("type")&&getLiffToken(),"yes"==getParameterByName("auto")&&getParameterByName("type")&&sendLiffMessage(),initApp()}).catch(e=>{console.error("LIFF initialization failed",e)})}function initApp(){if(console.log("LIFF initialized!"),liff.isLoggedIn()){if(!liff.isInClient()&&void 0!==getParameterByName("type")){var e=document.getElementById("content"),t=document.createElement("a");t.href="#",t.id="liffLogout",t.className="btn btn-lg btn-danger btn-block",t.innerHTML="Log Out",e.insertBefore(t,e.childNodes[6])}liff.getProfile().then(e=>{const t=e.displayName;console.info("User name is",t),document.getElementById("greet").innerHTML="Hi, "+t+" à±¼ Nice to meet you"}).catch(e=>{console.error("LIFF getProfile failed",e)})}else{var a=document.getElementById("liffSendMessage");a.innerHTML="Log In",a.id="liffLogin"}registerButtonHandlers()}function registerButtonHandlers(){sendMessageButton=document.getElementById("liffSendMessage"),loginButton=document.getElementById("liffLogin"),logoutButton=document.getElementById("liffLogout"),sendMessageButton&&liff.isInClient()?sendMessageButton.addEventListener("click",sendLiffMessage,!1):sendMessageButton&&!liff.isInClient()?logoutButton.addEventListener("click",logoutLiff,!1):loginButton.addEventListener("click",loginLiff,!1)}function changeType(){var e=document.getElementById("type").value;removeElements("form-label-group"),initContent(e)}function initContent(e){var t=!0,a=document.createElement("div"),n=document.createElement("input"),l=document.createElement("label"),o=document.createElement("textarea");e||((e=getParameterByName("type"))&&(document.getElementById("type").value=e),document.getElementById("type").selectedIndex<=0&&(document.getElementById("type").value="choose"),t=!1),getParameterByName("liffId")&&(liffId=getParameterByName("liffId"));var i=document.getElementById("content");"text"==e?(a.className="form-label-group",a.id="data",n.type="text",n.id="text",n.className="form-control",n.placeholder="Text message",n.required=!0,getParameterByName("text")&&(n.value=getParameterByName("text")),l.htmlFor="text",l.innerHTML="Text message",a.appendChild(n),a.appendChild(l),i.insertBefore(a,i.childNodes[4])):"sticker"==e||"stickerimage"==e?(a.className="form-label-group",a.id="data",n.type="text",n.id="packageId",n.className="form-control",n.placeholder="Text message",n.required=!0,getParameterByName("packageId")&&(n.value=getParameterByName("packageId")),l.htmlFor="packageId",l.innerHTML="Sticker Package ID",a.appendChild(n),a.appendChild(l),i.insertBefore(a,i.childNodes[4]),a=document.createElement("div"),n=document.createElement("input"),l=document.createElement("label"),a.className="form-label-group",a.id="data",n.type="text",n.id="stickerId",n.className="form-control",n.placeholder="Preview image url",n.required=!0,getParameterByName("stickerId")&&(n.value=getParameterByName("stickerId")),l.htmlFor="stickerId",l.innerHTML="Sticker ID",a.appendChild(n),a.appendChild(l),i.insertBefore(a,i.childNodes[4]),a=document.createElement("div"),checkbox=document.createElement("div"),n=document.createElement("input"),l=document.createElement("label"),checkbox.className="form-label-group",checkbox.id="data",a.className="custom-control custom-checkbox",n.type="checkbox",n.id="animation",n.className="custom-control-input","yes"==getParameterByName("animation")&&(n.checked=!0),l.htmlFor="animation",l.className="custom-control-label",l.innerHTML="Animation",a.appendChild(n),a.appendChild(l),checkbox.appendChild(a),i.insertBefore(checkbox,i.childNodes[4])):"image"==e||"video"==e?(a.className="form-label-group",a.id="data",n.type="text",n.id="downloadUrl",n.className="form-control",n.placeholder="Original content url",n.required=!0,getParameterByName("downloadUrl")&&(n.value=getParameterByName("downloadUrl")),l.htmlFor="downloadUrl",l.innerHTML="Download URL",a.appendChild(n),a.appendChild(l),i.insertBefore(a,i.childNodes[4]),a=document.createElement("div"),n=document.createElement("input"),l=document.createElement("label"),a.className="form-label-group",a.id="data",n.type="text",n.id="previewUrl",n.className="form-control",n.placeholder="Preview image url",n.required=!0,getParameterByName("previewUrl")&&(n.value=getParameterByName("previewUrl")),l.htmlFor="previewUrl",l.innerHTML="Preview URL",a.appendChild(n),a.appendChild(l),i.insertBefore(a,i.childNodes[4])):"audio"==e?(a.className="form-label-group",a.id="data",n.type="text",n.id="downloadUrl",n.className="form-control",n.placeholder="Original content url",n.required=!0,getParameterByName("downloadUrl")&&(n.value=getParameterByName("downloadUrl")),l.htmlFor="downloadUrl",l.innerHTML="Download URL",a.appendChild(n),a.appendChild(l),i.insertBefore(a,i.childNodes[4])):"messages"==e?(a.className="form-label-group",a.id="data",o.id="messages",o.className="form-control",o.placeholder="Messages json",o.rows="5",getParameterByName("messages")&&(o.value=getParameterByName("messages")),a.appendChild(o),i.insertBefore(a,i.childNodes[4])):"messagesUrl"==e?(a.className="form-label-group",a.id="data",n.type="text",n.id="messagesUrl",n.className="form-control",n.placeholder="Messages json url",n.required=!0,getParameterByName("messagesUrl")&&(n.value=getParameterByName("messagesUrl")),l.htmlFor="messagesUrl",l.innerHTML="Messages JSON URL",a.appendChild(n),a.appendChild(l),i.insertBefore(a,i.childNodes[4])):"scanQr"==e?(a.className="form-label-group",a.id="data",n.type="text",n.id="qrResult",n.className="form-control",n.placeholder="QR Code Result",n.required=!0,l.htmlFor="qrResult",l.innerHTML="QR Code Result",a.appendChild(n),a.appendChild(l),i.insertBefore(a,i.childNodes[4]),scanCodeQr()):"liffToken"==e?(a.className="form-label-group",a.id="data",n.type="text",n.id="liffToken",n.className="form-control",n.placeholder="Liff Auth Token",n.required=!0,l.htmlFor="liffToken",l.innerHTML="Liff Auth Token",a.appendChild(n),a.appendChild(l),i.insertBefore(a,i.childNodes[4]),t&&getLiffToken()):"genToken"==e&&(a.className="form-label-group",a.id="data",n.type="text",n.id="lineAuthKey",n.className="form-control",n.placeholder="Line Auth Key",n.required=!0,getParameterByName("lineAuthKey")&&(n.value=getParameterByName("lineAuthKey")),l.htmlFor="lineAuthKey",l.innerHTML="Line Auth Key",a.appendChild(n),a.appendChild(l),i.insertBefore(a,i.childNodes[4]))}function sendLiffMessage(){var e=document.getElementById("type").value,t=new HttpClient,a="Unknown",n="https://salernoletteratura.com/uploads/author/AXC_5666.png",l="";if(liff.getProfile().then(e=>{a=e.displayName,n=e.pictureUrl,l=e.statusMessage}).catch(e=>{console.error("Error while get profile",e)}),"profile"==e)sendMessages([{type:"flex",altText:"Profile "+a,contents:{type:"bubble",hero:{type:"image",url:n,size:"full",aspectRatio:"1:1",aspectMode:"cover",action:{type:"uri",uri:"line://app/1584968724-qzg0aR95?auto=yes&type=image&downloadUrl="+n+"&previewUrl="+n}},body:{type:"box",layout:"vertical",contents:[{type:"text",text:a,align:"center",weight:"bold",size:"xl"},{type:"box",layout:"vertical",margin:"lg",spacing:"sm",contents:[{type:"text",text:l,wrap:!0,color:"#666666",size:"sm",maxLines:5,flex:5}]}]},footer:{type:"box",layout:"horizontal",spacing:"sm",contents:[{type:"button",style:"primary",height:"sm",color:"#02afff",action:{type:"uri",label:"Open Chat",uri:"https://line.me/ti/g2/JGUODBE4RE"}},{type:"button",style:"primary",height:"sm",action:{type:"uri",label:"Profile",uri:"line://app/1584968724-qzg0aR95?auto=yes&type=profile"}},{type:"spacer",size:"sm"}]}}}]);else if("text"==e)sendMessages([{type:"text",text:document.getElementById("text").value}]);else if("sticker"==e)sendMessages([{type:"sticker",packageId:document.getElementById("packageId").value,stickerId:document.getElementById("stickerId").value}]);else if("stickerimage"==e)stickerId=document.getElementById("stickerId").value,packageId=document.getElementById("packageId").value,animation=document.getElementById("animation").checked,1==animation?imageUrl="https://stickershop.line-scdn.net/stickershop/v1/sticker/"+stickerId+"/IOS/sticker_animation@2x.png":imageUrl="https://stickershop.line-scdn.net/stickershop/v1/sticker/"+stickerId+"/IOS/sticker@2x.png",sendMessages([{type:"template",altText:a+" sent a sticker.",template:{type:"image_carousel",columns:[{imageUrl:imageUrl,action:{type:"uri",uri:"line://shop/sticker/detail/"+packageId}}]}}]);else if("image"==e)sendMessages([{type:"image",originalContentUrl:document.getElementById("downloadUrl").value,previewImageUrl:document.getElementById("previewUrl").value}]);else if("video"==e)sendMessages([{type:"video",originalContentUrl:document.getElementById("downloadUrl").value,previewImageUrl:document.getElementById("previewUrl").value}]);else if("audio"==e)sendMessages([{type:"audio",originalContentUrl:document.getElementById("downloadUrl").value,duration:6e4}]);else if("messages"==e)sendMessages(JSON.parse(document.getElementById("messages").value));else if("messagesUrl"==e){var o=document.getElementById("messagesUrl").value;t.get(o,function(e){sendMessages(JSON.parse(e))}).catch(e=>{console.error("Parsing messages failed",e)})}else"scanQr"==e?sendMessages([{type:"text",text:document.getElementById("qrResult").value}]):"liffToken"==e?sendMessages([{type:"text",text:document.getElementById("liffToken").value}]):"genToken"==e&&t.get("generateToken.php?lineAuthKey="+document.getElementById("lineAuthKey").value,function(e){sendMessages([{type:"text",text:e}])}).catch(e=>{console.error("Generate token failed",e)})}function sendMessages(e){liff.isInClient()?(console.info("Start sending message"),liff.sendMessages(e).then(()=>{console.info("Success sending message"),liff.closeWindow()}).catch(e=>{console.error("Sending message failed",e)})):sendAlertIfNotInClient()}function getLiffToken(){liff.isLoggedIn()?document.getElementById("liffToken").value=liff.getAccessToken():document.getElementById("liffToken").value="You must login first"}function scanCodeQr(){liff.isInClient()?(console.info("Start scan code qr"),liff.scanCode().then(e=>{document.getElementById("qrResult").value=e.value}).catch(e=>{console.error("Scan code qr failed",e)})):sendAlertIfNotInClient()}function loginLiff(){liff.isLoggedIn()||liff.login()}function logoutLiff(){liff.isLoggedIn()&&(liff.logout(),window.location.reload())}function getParameterByName(e){var t=null;return e=e.replace(/[\[\]]/g,"\\$&"),params[e]&&(t=unescape(params[e])),t}function getParameterByNameV2(e){e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(url);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}function removeElements(e){for(var t=document.getElementsByClassName(e),a=t.length-1;0<=a;a--)t[a]&&t[a].parentElement&&t[a].id&&"data"==t[a].id&&t[a].parentElement.removeChild(t[a])}function sendAlertIfNotInClient(){alert("This button is unavailable as LIFF is currently being opened in an external browser.")}